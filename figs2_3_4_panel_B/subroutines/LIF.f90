!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!                                                                            !!!!!!!!
!!!!!!!!        LEAKY INTEGRATE-AND-FIRE NEURON NUMERICAL INTEGRATION               !!!!!!!!
!!!!!!!!                                                                            !!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
	SUBROUTINE lif()
	USE PARAMETERS
	USE VARIABLES
	IMPLICIT NONE
	REAL*8		::	tot_cond,u_inf,tau_eff,decay_eff

!================================= POST-SYNAPTIC NEURON ===================================!
!---------------------------if not in refractory period------------------------------------!
	IF((tr-spkt_post).GT.pr(3)) THEN
	!-------------------------------total conductance------------------------------------------!
		tot_cond = 1.0d0 + x(3) + x(4)
	!-----------------------------------u_infinity---------------------------------------------!
		u_inf = pr(2) + x(4)*pr(32)
		u_inf = u_inf/tot_cond
	!----------------------------------tau_effective-------------------------------------------!
		tau_eff = pr(1)/tot_cond
	!------------------------------new exponential for solution--------------------------------!
		decay_eff = DEXP(-dt/tau_eff)
	!-----------------------update of membrane potential of dendrite---------------------------!
		x(1) = x(1)*decay_eff + u_inf*(1.0d0-decay_eff)
	END IF
!------------------------------------------------------------------------------------------!
!---------------------------------decay of AMPA conductance--------------------------------!
	x(3) = x(3)*pr(35)
!---------------------------------decay of GABA conductance--------------------------------!
	x(4) = x(4)*pr(36)
!----------------------------------reset variable spk_post---------------------------------!
	spk_post = .FALSE.
!------------------------------------spiking threshold-------------------------------------!
	IF(x(1).GE.pr(4)) THEN
	!---------------------------------spike time-----------------------------------------------!
		spkt_post = tr
	!--------------------------update variable spk_post----------------------------------------!
		spk_post = .TRUE.
	!-------------------------------reset memb potential---------------------------------------!
		x(1) = pr(2)
	END IF
!------------------------------------------------------------------------------------------!
!==========================================================================================!
	END SUBROUTINE
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
